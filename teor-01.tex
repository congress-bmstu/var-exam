\que{Унимодальные функции. Свойства унимодальных функций, связь унимодальных и выпуклых непрерывных функций одной переменной (с доказательством). Одномерная оптимизация: метод деления отрезка пополам.}

\begin{definition}
	Функция $f(x): [a, b] \to \mathbb{R}$ называется \textit{унимодальной}, если она непрерывна на $[a, b]$ и существуют такие $\alpha, \beta \in \mathbb{R}$, что $a \leqslant \alpha \leqslant \beta \leqslant b$ и 
	\begin{enumerate}[label={\arabic*)}]
		\item функция $f(x)$ строго монотонно убывает на $[a, \alpha]$, т.е. $(\forall x_1, x_2 \in [a, \alpha]) \, x_1 < x_2 \Rightarrow f(x_1) > f(x_2)$;
		
		\item $f(x) = c (c \in \mathbb{R})$ для всех $x \in [\alpha, \beta]$;
		
		\item функция $f(x)$ строго монотонно возрастает на $[a, \alpha]$, то есть $(\forall x_1, x_2 \in [\beta, b]) x_1 < x_2 \Rightarrow f(x_1) < f(x_2)$.
	\end{enumerate}
	
	Функция называется \textit{строго унимодальной}, если $\alpha = \beta$.
\end{definition}

\begin{utv}
	Для унимодальной функции
	
	$\begin{array}{l}
		\text{множество точек минимума } \Omega_{\ast} = [\alpha, \beta] \\
		\text{минимум } m_{\ast} = c
	\end{array}$
\end{utv}

\begin{utv}
	Выпуклая вниз непрерывная функция на $[a, b]$ является унимодальной на $[a, b]$.
\end{utv}

\begin{utv}
	Ясно, что если функция $f(x)$ унимодальна на $[a, b]$ и $[c, d] \subset [a, b]$, то $f(x)$ унимодальна на $[c, d]$. 
\end{utv}

\begin{theorem}
	Всякая выпуклая (вниз) непрерывная функция (1-й переменной) на отрезке является унимодальной.
\end{theorem}
\begin{proof}
	$f(x)$ непрерывна, выпукла (вниз) на $[a, b]$. Тогда $f(x)$ принимает на $[a, b]$ свое минимальное значение $m$ (теорема Вейерштрасса).
	\begin{enumerate}[label={(\arabic*)}]
		\item Пусть $c_2$ --- самая большая точка $f(c_2) = m; f(x) > 0$ на $(c_2, b]$. Если $c_2 = b$, то доказывать нечего. 
		
		Пусть $c_2 < b$, доказываем, что $f(x)$ строго убывает на $[c_2, b]$. 
		
		Доказываем от противного.
		
		Пусть $\exists x_1, x_2 \in [c_2, b], c_2 \leqslant x_1 < x_2 \leqslant b$. Считаем, что $f(x_1) \geqslant f(x_2) > f(c_2)$.
		
		Рассмотрим $[c_2, x_2], \, x_1 \in [c_2, x_2] \Rightarrow \exists \lambda \in [0, 1], x_1 = \lambda c_1 + (1 - \lambda) x_2 (\text{если } \lambda = 0, \text{ тогда } x_1 = x_2) \Rightarrow$ так как $f$ выпуклая функция $f(x_1) = f(\lambda c_2 + (1 - \lambda) x_2) \leqslant \lambda f(c_2) + (1 - \lambda) f(x_2) < \lambda f(x_2) + (1 - \lambda) f(x_2) = f(x_2)$, то есть $f(x_1) < f(x_2)$ --- получили противоречие. Таким образом, $f$ строго убывает на $[c_2, b]$.
		
		\item Аналогично, $f(x)$ строго возрастает на отрезке $[a, c_1]$, где $c_1$ --- самая малая точка $f(c_1) = m$.
		
		\item Рассмотрим $c \in (c_1, c_2) \Rightarrow \exists \lambda \in (0, 1), c = \lambda c_1 + (1 - \lambda) c_2 (c_1 \not = c_2)$.
		
		Тогда $f(c) = f(\lambda c_1 + (1 - \lambda) c_2) \leqslant \lambda \underbrace{f(c_1)}_{= m} + (1 - \lambda) \underbrace{f(c_2)}_{= m} = \lambda m + (1 - \lambda) m = m$.
		
		Но $m$ --- минимальное значение $\Rightarrow f(c) = m$.
	\end{enumerate}
\end{proof}

\begin{utv}
	Обратное неверно, например: $y = - x^2$ на $[0, 1]$.
\end{utv}

\paragraph{Метод деления отрезка (почти) пополам.}  Пусть $f(x)$ унимодальна на $[a, b]$. Выберем параметры $\delta, 0 < \delta < b - a$, $l([a, b]) = b - a$.
\newline

Выберем две точки: $u_1 = \frac{a + b - \delta}{2}$ и $u_2 = \frac{a + b + \delta}{2}$ (см. Рис. \ref{half}).  Вычислим $f(u_1)$ и $f(u_2)$: 
\begin{enumerate}[label={\arabic*)}]
	\item $f(u_1) \leqslant f(u_2) \Rightarrow$ полагаем: $a_2 = a_1, \, b_2 = u_2$;
	\item $f(u_1 ) > f(u_2) \Rightarrow$ полагаем $a_2 = u_1, \, b_2 = b_1$.
\end{enumerate}

Получаем $f$ унимодальна на $[a_2, b_2]$, $l([a_2, b_2]) = b_2 - a_2 = \frac{b - a + \delta}{2}$. И так далее \dots
\newline

Опишем $k$-й шаг.

Имеется $[a_k, b_k]$, $\Omega_{\ast} \cap [a_k, b_k] \not = \emptyset$ --- множество точек минимума.

$u_{2 k - 1} = \frac{a_k + b_k - \delta}{2}, u_{2 k} = \frac{a_k + b_k + \delta}{2}$. Вычисляем $f(u_{2 k - 1})$ и $f(u_{2 k})$.
\begin{enumerate}[label={\arabic*)}]
	\item  $f(u_{2 k - 1}) \leqslant f(u_{2 k}) \Rightarrow a_{k + 1} = a_k, \, b_{k + 1} = u_{2 k}$;
	\item $f(u_{2 k - 1}) > f(u_{2 k}) \Rightarrow a_{k + 1} = u_{2 k - 1}, \, b_{k + 1} = b_k$.  
\end{enumerate}

$l([a_{k + 1}, b_{k + 1}]) = \frac{b - a - \delta}{2^{k + 1}} + \delta > \delta$.
\newline

\begin{wrapfigure}[10]{r}{0.5\linewidth}
	\centering
	\includesvg[scale=0.8]{half}
	\caption{Иллюстрация первого шага.}
	\label{half}
\end{wrapfigure}

\textit{Условия остановки алгоритма:}
\begin{enumerate}
	\item $l([a_k, b_k]) < \varepsilon$, где $\varepsilon$ --- заранее выбранное число, $\varepsilon > 0$; 
	
	\item если проведено заданное число итераций.
\end{enumerate}

\textit{Точка минимума} $\bar{u}_n$:
\begin{enumerate}[label={(\alph*)}]
	\item $f(u_{2k - 1}) \leqslant f(u_{2 k}) \Rightarrow \bar{u}_n = u_{2 k - 1}$;
	
	\item $f(u_{2 k - 1}) > f(u_{2k}) \Rightarrow \bar{u}_n = u_{2 k}$.
\end{enumerate}

Минимум функции $m_{\ast} \approx f(\bar{u}_n)$.
\newline